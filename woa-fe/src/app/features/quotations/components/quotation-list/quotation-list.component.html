<div class="quotation-list-container">
  <!-- Header -->
  <mat-toolbar class="header-toolbar">
    <mat-toolbar-row>
      <span>Quotations</span>
      <span class="spacer"></span>
      <button mat-raised-button color="primary" (click)="openAddDialog()">
        <mat-icon>add</mat-icon>
        Add Quotation
      </button>
    </mat-toolbar-row>
  </mat-toolbar>

  <!-- Sort Controls -->
  <mat-card class="controls-card">
    <mat-card-content>
      <div class="controls-row">
        <!-- Sort -->
        <mat-form-field class="sort-field">
          <mat-label>Sort by</mat-label>
          <mat-select [formControl]="sortControl">
            <mat-option *ngFor="let option of sortOptions" [value]="option.value">
              {{option.label}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Loading Spinner -->
  <div class="loading-container" *ngIf="loading">
    <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
  </div>

  <!-- Message Display -->
  <div class="message" *ngIf="message" [class.error]="message.includes('Error')">
    {{ message }}
  </div>

  <!-- Results Summary -->
  <div class="results-summary" *ngIf="!loading">
    Showing {{ quotations.length }} quotations
  </div>

  <!-- Quotations Table -->
  <mat-card class="table-card" *ngIf="!loading">
    <mat-table [dataSource]="quotations" class="quotations-table">
      
      <!-- Author Column -->
      <ng-container matColumnDef="author">
        <mat-header-cell *matHeaderCellDef>Author</mat-header-cell>
        <mat-cell *matCellDef="let quotation">
          <div class="author-cell">
            <div class="author-avatar">
              {{ getAuthorInitials(quotation.author) }}
            </div>
            <div class="author-info">
              <div class="author-name">{{ quotation.author }}</div>
              <div class="quotation-date">{{ formatDate(quotation.date) }}</div>
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <!-- Quotation Column -->
      <ng-container matColumnDef="quotation">
        <mat-header-cell *matHeaderCellDef>Quotation</mat-header-cell>
        <mat-cell *matCellDef="let quotation">
          <div class="quotation-cell">
            <div class="quotation-text">
              "{{ truncateText(quotation.quotation) }}"
            </div>
            <div class="quotation-meta">
              <span class="created-date">Added: {{ formatDate(quotation.createdAt) }}</span>
            </div>
          </div>
        </mat-cell>
      </ng-container>

      <!-- Date Column -->
      <ng-container matColumnDef="date">
        <mat-header-cell *matHeaderCellDef>Quote Date</mat-header-cell>
        <mat-cell *matCellDef="let quotation">
          <div class="date-cell">
            <mat-icon class="date-icon">event</mat-icon>
            {{ formatDate(quotation.date) }}
          </div>
        </mat-cell>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
        <mat-cell *matCellDef="let quotation">
          <div class="actions-cell">
            <button mat-icon-button 
                    color="primary" 
                    (click)="openEditDialog(quotation)"
                    matTooltip="Edit quotation">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button 
                    color="warn" 
                    (click)="deleteQuotation(quotation.id)"
                    matTooltip="Delete quotation">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
    </mat-table>

    <!-- No Results -->
    <div class="no-results" *ngIf="quotations.length === 0 && !loading">
      <mat-icon class="no-results-icon">format_quote</mat-icon>
      <h3>No quotations found</h3>
      <p>
        <button mat-raised-button color="primary" (click)="openAddDialog()">
          Add your first quotation
        </button>
      </p>
    </div>
  </mat-card>
</div>
